<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<div th:fragment="headerBar" th:remove="tag">
  <style>

body {
  margin: 0;
}

header {
  background-color: #333;
  color: #fff;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  padding: 0px 0;
  top: 0;
}

.header-wrapper {
  display: flex;
  justify-content: space-between;
  align-items: center;
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 20px;
}

.header-wrapper .dropdown-bar{
  position: absolute;
  top: 70px;
  max-width: 907px;
  width: 100%;
}

.logo {
  font-size: 24px;
  font-weight: bold;
  cursor: pointer;
  text-decoration: none;
  color: #FAFAFA;
  display: block;
}

.search-bar {
  display: flex;
  align-items: center;
  background-color: #f2f2f2;
  border-radius: 10px;
  padding: 5px 5px;
  width: 100%;
  margin: 15px;
}

.search-input {
  border: none;
  background-color: transparent;
  width: 100%;
  padding: 5px 10px;
  font-size: 16px;
}

.search-button {
  background-color: #FEBD69;
  border: 3px solid #FEBD69;
  border-radius: 10px;
  background-image: url('../images/search.png');
  background-size: cover;
  width: 40px;
  height: 40px;
  cursor: pointer;
  font-size: 16px;
  margin-left: 5px;
}

.navigationBar {
        background-color: #232F3E;
        height: 30px;

    }

    .navigationList {
        margin: 0;
        padding: 0;
        list-style: none;
        display: flex;
        max-width: 1200px;
    }

    .navigationList li {
        flex: 1;
        text-align: center;
    }

    .navigationList a {
        display: block;
        color: white;
        text-align: center;
        padding: 6px;
        text-decoration: none;
    }

    .navigationList a:hover {
        cursor: pointer;
        background-color: #555;
    }

    /* Style for dropdown */
		.dropdown {
			position: relative;
			display: none;
			padding: 10px;
			background-color: #fff;
			box-shadow: 0 0 10px rgba(0,0,0,0.2);
			z-index: 1;
		}
		.dropdown a {
			display: block;
			padding: 5px;
			color: #333;
			text-decoration: none;
			cursor: pointer;
		}
		.dropdown a:hover {
			background-color: #f4f4f4;
		}

</style>
  <header>
    <div th:insert="/sideMenu :: sidebar"></div>
    <div class="header-wrapper">
      <a class="logo" th:href="@{/}">Internet-Shop Iberia</a>
      <div class="search-bar">
        <form style="display: flex; width: 100%;" method="get" th:action="@{/search}">
          <input class="search-input" type="text" th:value="${searchRequest}" name="searchRequest" placeholder="Search...">
          <button class="search-button" type="submit"><i class="fa fa-search"></i></button>
        </form>
        <div class="dropdown-bar">
          <div class="dropdown">
            <div id="dropdown">
              <div th:if="${searchResults != null} and ${#lists.size(searchResults.results) >= 1}">
                <script th:inline="javascript">
                  var dropdown = document.querySelector('.search-bar .dropdown');
                  if(dropdown.style.display != 'block'){
                    dropdown.style.display = 'block';
                  }
                </script>
                <div th:each="result : ${searchResults.results}">
                  <a th:href="@{/search(searchRequest=${result})}" th:text="${result}"></a>
                </div>
              </div>
              <div th:unless="${searchResults != null} and ${#lists.size(searchResults.results) >= 1}">
                <script th:inline="javascript">
                  var dropdown = document.querySelector('.search-bar .dropdown');
                  if(dropdown.style.display != 'none'){
                    dropdown.style.display = 'none';
                  }
                </script>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div>
        Cart
      </div>
      <div>
        Language
      </div>
    </div>
    <nav class="navigationBar">
      <ul class="navigationList">
        <li><a><div th:insert="/sideMenu :: sidebarButton"></div></a></li>
        <li><a href="#">Home</a></li>
        <li><a href="#">About</a></li>
        <li><a href="#">Services</a></li>
        <li><a href="#">Portfolio</a></li>
        <li><a href="#">Contact</a></li>
      </ul>
    </nav>
  </header>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
  <script type="text/javascript">
        function updateSearchResults(value) {
            $.get("s?searchInput="+value).done(function(fragment) { // get from controller
                $("#dropdown").replaceWith(fragment); // update snippet of page
            });
        }
		// Show/hide dropdown on input focus/blur
		var searchInput = document.querySelector('.search-bar input[type="text"]');
		var dropdown = document.querySelector('.search-bar .dropdown');
		searchInput.addEventListener('focus', function() {
		  updateSearchResults(searchInput.value);
		});
		searchInput.addEventListener('blur', function() {
			setTimeout(function() {
				dropdown.style.display = 'none';
			}, 200);
		});
		searchInput.addEventListener("input", function(e) {
		  updateSearchResults(e.target.value);
		});
		// Select dropdown item on click
		var dropdownLinks = document.querySelectorAll('.search-bar .dropdown a');
		for (var i = 0; i < dropdownLinks.length; i++) {
			dropdownLinks[i].addEventListener('click', function(e) {
				e.preventDefault();
				searchInput.value = this.textContent;
				dropdown.style.display = 'none';
                updateSearchResults(this.textContent);
			});
		}
	</script>
</div>
</html>